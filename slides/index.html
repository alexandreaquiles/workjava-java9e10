<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Novidades do Java 9 (e 10)</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<style>
			small.baseline {
				vertical-align: baseline;			
			}
		</style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				
				<section>
					<h2>Novidades do Java 9 (e 10)</h2>
				</section>
				
				<section>
					<h3>Alexandre Aquiles</h3>
					<p>Instrutor e Desenvolvedor na Caelum</p>
					<ul>
						<li>Twitter: <a href="https://twitter.com/alex_aquiles">@alex_aquiles</a></li>
						<li>Blog: <a href="https://alexandreaquiles.com.br">alexandreaquiles.com.br</a></li>
						<li>GitHub: <a href="https://github.com/alexandreaquiles">github.com/alexandreaquiles</a></li>
						<li>Livro: <a href="https://www.casadocodigo.com.br/products/livro-git-github">Controlando Versões com Git e GitHub</a></li>
					</ul>
				</section>

				<section>
					<h3>Temas</h3>
					<ul>
						<li>Interatividade com o JShell <small class="baseline"> - Java 9</small></li>
						<li>Mudanças nas APIs <small class="baseline"> - Java 9</small></li>
						<li><strong>Sistema de módulos</strong> <small class="baseline"> - Java 9</small></li>
						<li>var <small class="baseline"> - Java 10</small></li>
					</ul>
				</section>

				<section>

					<h3>Muitas novidades no Java 9</h3>

					<p><small><strong>Java 8:</strong> 55 JEPs entregues</small></p>
					<!-- http://openjdk.java.net/projects/jdk8/features -->

					<p>
					<strong>Java 9:</strong> 91 JEPs entregues<br/>
					<small><a href="http://openjdk.java.net/projects/jdk9/">http://openjdk.java.net/projects/jdk9/</a></small></p>

					<p>Focaremos nas mais importantes</p>

				</section>

				<section>
					<p>Java é chato para explorar as APIs.</p>

					<p>Sempre aquela mesma coisa:</p>

					<pre><code class="hljs java">
public class Teste {
	public static void main (String[] args) {
		//código aqui...
	}
}
						</code></pre>
					</section>

					<section>
						<h3>Java Interativo</h3>

						<p>O Java 9 introduz um REPL:</p>
						<p><strong>jshell</strong></p>
					</section>

					<section>
						<p>DEMO</p>
					</section>

					<section>
						<small>
							<p><code>/exit</code></p>
							<p><code>/vars</code></p>
							<p><code>/list</code></p>
							<p><code>/drop</code></p>
							<p><code>/edit</code></p>
							<p><code>/set editor</code></p>
							<p><code>/reset</code></p>
							<p><code>/imports</code></p>
							<p><code>/open</code></p>
							<p><code>/save</code></p>
						</small>
					</section>

					<section>
						<h3>Mudanças nas APIs do Java 9</h3>
					</section>

					<section>
						<p>DEMO</p>
					</section>

					<section>
							<p><code>List.of</code></p>
							<p><code>Set.of</code></p>
							<p><code>Map.of</code></p>
					</section>

					<section>
						<p><code>LocalDate.datesUntil</code></p>
					</section>

					<section>
						<p><code>Stream.iterate</code></p>
						<p><code>Stream.takeWhile</code></p>
						<p><code>Stream.dropWhile</code></p>
						<p><code>Stream.ofNullable</code></p>
					</section>

					<section>
						<p>Tem mais...</p>
						<small>
							<p><code>Optional.or</code></p>
							<p><code>Optional.stream</code></p>
							<p><code>Optional.ifPresentOrElse</code></p>
							<p><code>Collectors.flatMapping</code></p>
							<p><code>Collectors.filtering</code></p>
						</small>
					</section>

					<section>
						<h5>Busca no Javadoc</h5>
						<p><small><a href="https://docs.oracle.com/javase/9/docs/api/overview-summary.html">https://docs.oracle.com/javase/9/docs/api/overview-summary.html</a></small></p>
					</section>

					<section>
						<h3>Java Platform Module System (JPMS)</h3>
					</section>

					<section>
						<p>rt.jar do JDK 7 b65</p>
						<img src="images/jdk7-rt-jar.jpg"/>
						<p>
							<small>
								<a href="http://openjdk.java.net/projects/jigsaw/doc/jdk-modularization.html">Project Jigsaw: JDK modularization (mid 2009)</a>
							</small>
						</p>
					</section>

					<section>
						<p>
							<strong>base</strong>
								<small class="baseline">dependia de</small>
							<strong>Logging</strong>
								<small class="baseline">que dependia de</small>
							<strong>JMX</strong>
						</p>
						<p>
								<small class="baseline">que dependia de</small>
							<strong>JNDI</strong>
								<small class="baseline">que dependia de</small>
							<strong>Applet</strong>
						</p>
					</section>

					<section>
						<h3>JEP 200: The Modular JDK</h3>
						<img src="images/java.se-graph.png"/>
					</section>

					<section>
						<p>Módulo <strong>java.base</strong></p>
						<small>
							<p>java.lang</p>
							<p>java.util</p>
							<p>java.util.function</p>
							<p>java.util.stream</p>
							<p>java.time</p>
							<p>java.math</p>
							<p>java.text</p>
							<p>java.io</p>
							<p>java.nio</p>
							<p>java.net</p>
						</small>
					</section>

					<section>
						<p>Outros módulos</p>
						<small>						
							<p>java.sql</p>
							<p>java.desktop</p>
							<p>java.logging</p>
							<p>java.scripting</p>
							<p>...</p>
						</small>
					</section>

					<section>
						<h3>Erros ao atualizar para Java 9 &#9785;</h3>
					</section>

					<section>
						<p>DEMO</p>
					</section>

					<section>
						<h3>Class Path x Module Path</h3>
					</section>

					<section>
						<p>Módulo <code>java.se.ee</code></p>
						<img src="images/java.se-vs-java.se.ee.jpg"/>
						<p><small>Fonte: <a href="https://www.slideshare.net/PaulBakker1/migrating-to-java-9-modules-80519688">Migrating to Java 9 Modules, Paul Bakker</a></small></p>
					</section>

					<section>
						<p>--add-modules java.xml.bind</p>
					</section>

					<section>
						<h3>Unnamed Module</h3>
						<img src="images/classpath-modulepath.png">
					</section>

					<section>
						<img src="images/rodar-no-eclipse-java.xml.bind.png">
					</section>

					<section>
						<h3>Compilar com o Java 9</h3>
					</section>

					<section>
						<pre>
&lt;maven.compiler.source&gt;9&lt;/maven.compiler.source&gt;
&lt;maven.compiler.target&gt;9&lt;/maven.compiler.target&gt;
						</pre>
ou
						<pre>
&lt;maven.compiler.release&gt;9&lt;/maven.compiler.release&gt;
						</pre>
					</section>

					<section>
							<pre>
&lt;plugin&gt;
  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
      &lt;version&gt;3.7.0&lt;/version&gt;
      &lt;configuration&gt;
        &lt;compilerArgs&gt;
          &lt;arg&gt;--add-modules&lt;/arg&gt;
          &lt;arg&gt;java.xml.bind&lt;/arg&gt;
      &lt;/compilerArgs&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
							</pre>
					</section>

					<section>
							<pre>
&lt;plugin&gt;
  &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.21.0&lt;/version&gt;
  &lt;configuration&gt;
    &lt;argLine&gt;
      --add-modules java.xml.bind
    &lt;/argLine&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
							</pre>
					</section>

					<section>
						<img src="images/compilar-no-eclipse-java.xml.bind.png">
					</section>

					<section>
						<p><strong>JEP 320:</strong> Remove the Java EE and CORBA Modules</p>
						<small>
							<p>previsto para o JDK 11 (Setembro/2018)</p>
						</small>
					</section>

					<section>
							<pre>
&lt;dependency&gt;
  &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;
  &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;
  &lt;version&gt;2.3.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
  &lt;artifactId&gt;jaxb-core&lt;/artifactId&gt;
  &lt;version&gt;2.3.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
  &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt;
  &lt;version&gt;2.3.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.activation&lt;/groupId&gt;
  &lt;artifactId>javax.activation-api&lt;/artifactId&gt;
  &lt;version>1.2.0&lt;/version&gt;
&lt;/dependency&gt;
							</pre>
					</section>

					<section>
						<img src="images/classpath-modulepath-com-dependencias.png"/>
					</section>

					<section>
						<p>E o <strong>Java FX</strong>?</p>
						<p>Será que funciona sem configurações a mais?</p>
					</section>

					<section>
						<p>DEMO</p>
					</section>

					<section>
						<p><code>java --show-module-resolution</code></p>
					</section>

					<section>
						<h3>Unnamed Module</h3>
						<p>pode usar (por padrão)</p>
						<small>
							<p>java.se</p>
							<p>javafx.base</p>
							<p>javafx.controls</p>
							<p>javafx.fxml</p>
							<p>jdk.net</p>
							<p>jdk.management</p>
							<p>...</p>
						</small>
					</section>

					<section>
						<h3>Modularizando o projeto</h3>
					</section>

					<section>
						<h3>Por que modularizar?</h3>
						<ul>
							<li>Para <strong>controlar as dependências</strong> entre partes do nosso código</li>
							<li>Para tornar a <strong>arquitetura explícita</strong> (não só um diagrama)</li>
						</ul>
					</section>

					<section>
						<h3>Módulos</h3>
						<ul>
							<li>Unidade de implantação</li>
							<li>Unidade de composição</li>
							<li>Unidade de reuso <small class="baseline">(bibliotecas)</small></li>
						</ul>
					</section>

					<section>
						<img src="images/modularity-patterns.jpg"/>
						<p>
							<small>
								<a href="https://www.amazon.com.br/Java-Application-Architecture-Modularity-Patterns/dp/0321247132">Java Application Architecture: Modularity Patterns, Kirk Knoernschild (2012)</a>
							</small>
						</p>
					</section>

					<section>
						<img src="images/modularizacao.png"/>
					</section>

					<section>
						<h3>Módulos Maven?</h3>
					</section>

					<section>
						<p>DEMO</p>
					</section>

					<section>
						<h3>Módulos Maven</h3>
						<p>Funcionam com Java 8 &#10004;</p>
						<p>Encapsulamento &#10007;</p>
						<p>
							<img src="images/modularizacao-sem-encapsulamento.png" />
						</p>
					</section>

					<section>
						<h3>Módulos Maven e JARs &#9786;</h3>
						<img src="images/nicolai-module-dependency-graph-jars.png"/>
						<p>
							<small>
								<a href="https://www.manning.com/books/the-java-module-system">The Java Module System, Nicolai Parlog (2018, est.)</a>
							</small>
						</p>
					</section>

					<section>
						<h3>Class Path no runtime &#9785;</h3>
						<img src="images/nicolai-module-big-ball-of-mud-classpath.png"/>
						<p>
							<small>
								<a href="https://www.manning.com/books/the-java-module-system">The Java Module System, Nicolai Parlog (2018, est.)</a>
							</small>
						</p>
					</section>

					<section>
						<h3>Module erasure</h3>
						<ul>
							<li>Class Path é apenas uma lista de classes</li>
							<li>JAR é apenas um ZIP</li>
							<li>Dependências entre JARs não são mantidas em runtime</li>
						</ul>
					</section>

					<section>
						<h3>JSR 376/JEP 261: Module System</h3>
					</section>

					<section>
						<p>module-info.java</p>
						<pre><code>
module br.com.empresa.modulo {
  exports br.com.empresa.pacote;
  requires br.com.empresa.outro.modulo;
}
						</code></pre>
					</section>

					<section>
						<p>module-info.java</p>
						<pre><code>
module br.com.empresa.modulo {
  exports br.com.empresa.pacote 
       to br.com.empresa.outro.modulo;
  requires br.com.empresa.outro.modulo;
}
						</code></pre>
					</section>

					<section>
						<p>DEMO</p>
					</section>

					<section>
            <h3>Manifest.MF</h3>
            <pre><code>
Automatic-Module-Name: br.com.empresa.modulo
            </code></pre>
					</section>

					<section>
						<p>jar --file arquivo.jar --describe-module</p>
					</section>

					<section>
						<p><small><del>java -cp diretorio ClassePrincipal</del></small></p>
						
						<p><small><code>java -p diretorio --module modulo/ClassePrincipal</code></small></p>
						<p>ou</p>
						<p><small><code>java --module-path diretorio <br>--module modulo/ClassePrincipal</code></small></p>
					</section>
					<section>
						<h3>Dependências Transitivas</h3>
						<pre><code>
module br.com.empresa.modulo {
  //...
  requires transitive br.com.empresa.outro.modulo;
}
						</code></pre>
						</section>

					<section>
						<h3>Reflection</h3>
						<pre><code>
open module br.com.empresa.modulo {
  //...
}
						</code></pre>
					</section>

					<section>
						<h3>Reflection</h3>
						<pre><code>
module br.com.empresa.modulo {
  //...
  opens br.com.empresa.pacote;
}
						</code></pre>
					</section>

					<section>
						<h3>Reflection</h3>
						<pre><code>
module br.com.empresa.modulo {
  //...
  opens br.com.empresa.pacote 
    to br.com.empresa.outro.modulo;
}
						</code></pre>
					</section>

					<section>
						<h3>JPMS</h3>
						<ul>
							<li>Encapsulamento forte</li>
							<li>Configuração confiável</li>
						</ul>
					</section>

					<section>
						<h3>A Boa Modelagem</h3>
						<ul>
							<li>
								Proteger <strong>Regras de Negócio</strong> de mudanças
								<ul>
									<li>na Tela</li>
									<li>no BD</li>
									<li>nos frameworks</li>
								</ul>
							</li>
							<li>
								Isolar <strong>Mecanismos de Entrega</strong>
							</li>
						</ul>
					</section>

					<section>
            			<h3>Inversão de Dependências</h3>
						<img src="images/modularizacao-inversao-de-dependencias.png"/>
					</section>

					<section>
            			<h3>ServiceLoader API</h3>
						<pre><code>
module br.com.empresa.modulo {
  //...
  uses br.com.empresa.Servico;
}

module br.com.empresa.outro.modulo {
  //...
  provides br.com.empresa.Servico
    with br.com.empresa.Implementacao;
}
</pre></code>
						<p>
							<small>
								<a href="http://blog.caelum.com.br/plugins-em-java-com-service-providers/">Plugins em Java com Service Providers</a> (Java 8)
							</small>
						<br>
							<small>
								<a href="http://blog.caelum.com.br/simplicando-service-providers-com-modulos-do-java-9/">Simplificando Service Providers com módulos do Java 9+</a>
							</small>
						</p>
					</section>

					<section>
						<img src="images/HexagonalArchitecture.gif"/>
						<p>
							<small>
								<a href="http://alistair.cockburn.us/Hexagonal+architecture">Hexagonal Architecture, Alistair Cockburn (2005)</a>
							</small>
						</p>
					</section>

					<section>
						<img src="images/CleanArchitecture.jpg"/>
						<p>
							<small>
								<a href="https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html">The Clean Architecture, Uncle Bob (2012)</a>
							</small>
						</p>
					</section>

				  <section>
					<h3>Várias outras novidades no Java 9</h3>
					<small>
					  <p>JEP 282: jlink: The Java Linker</p>
					  <p>JEP 266: More Concurrency Updates <small class="baseline">(Reactive Streams)</small></p>
					  <p>JEP 248: Make G1 the Default Garbage Collector</p>
					  <p>JEP 254: Compact Strings <small class="baseline">byte[]</small></p>
					  <p>JEP 295: Ahead-of-Time Compilation <small class="baseline">(Graal)</small></p>
					  <p>JEP 264: Platform Logging API and Service</p>
					  <p>JEP 259: Stack-Walking API</p>
					  <p>...</p>
					</small>
				  </section>

				<section>
					<h3>Novidades do Java 10</h3>

								<p><small><strong>Java 8:</strong> 55 JEPs entregues</small></p>
								<!-- http://openjdk.java.net/projects/jdk8/features -->
								<p><small><strong>Java 9:</strong> 91 JEPs entregues</small></p>
								<!-- http://openjdk.java.net/projects/jdk9/ -->
								<p>
		  						<strong>Java 10:</strong> 12 JEPs entregues<br/>
		  						<small><a href="http://openjdk.java.net/projects/jdk/10/">http://openjdk.java.net/projects/jdk/10/</a></small>
					</p>
				</section>

				<section>
					<h3>JEP 286: Local-Variable Type Inference</h3>
				</section>

				<section>
					<p>DEMO</p>
				</section>

				<section>
					<h3>JEP 322: Time-Based Release Versioning</h3>
					<ul>
						<li>Nova versão a cada 6 meses (Março/Setembro)</li>
						<li>Time-box fechado, escopo aberto</li>
					</ul>
				</section>

				<section>
					<h4>Java Improvements for Docker Containers</h4>
					<small>					
						<p><a href="https://bugs.java.com/view_bug.do?bug_id=JDK-8146115">JDK-8146115</a>: Improve docker container detection and resource configuration usage</p>
						<p><a href="https://bugs.java.com/view_bug.do?bug_id=JDK-8186248">JDK-8186248</a>: Allow more flexibility in selecting Heap % of available RAM</p>
						<p><a href="https://bugs.java.com/view_bug.do?bug_id=JDK-8179498">JDK-8179498</a>: attach in Linux should be relative to /proc/pid/root and namespace aware</p>
					</small>
				</section>

				<section>
					<h3>Dúvidas?</h3>
					<p><a href="https://github.com/alexandreaquiles/workjava">https://github.com/alexandreaquiles/workjava</a></p>
				</section>

				</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			Reveal.initialize({
				progress: true,
				history: true,
				dependencies: [
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
